<div class="contenedor-formulario">
  <!-- Título dinámico -->
  <h2 class="titulo-form" [ngStyle]="resumen ? {'color': '#fff'} : {'color': '#004aad'}">
    {{ resumen ? 'Datos de la Reservación' : 'Reservación de Aula' }}
  </h2>

  <!-- FORMULARIO -->
  <form *ngIf="!resumen" class="form-grid">
    <div class="form-group">
      <label><i class="fas fa-user icono azul"></i> Nombre completo</label>
      <input type="text" [(ngModel)]="nombre" name="nombre" placeholder="Ingrese su nombre completo" required>
    </div>

    <div class="form-group">
      <label><i class="fas fa-id-card icono rojo"></i> Número de cuenta</label>
      <input type="text" [(ngModel)]="numeroCuenta" name="numeroCuenta" placeholder="Número de cuenta" required>
    </div>

    <div class="form-group">
      <label><i class="fas fa-envelope icono azul"></i> Correo educativo</label>
      <input type="email" [(ngModel)]="correo" name="correo" placeholder="ejemplo@unitec.edu" required>
    </div>

    <div class="form-group">
      <label><i class="fas fa-users icono beige"></i> Otros estudiantes</label>
      <div class="agregar-container">
        <input #nuevoEst type="text" placeholder="Nombre del estudiante" class="input-estudiante">
        <button type="button" class="btn-aceptar" (click)="agregarEstudiante(nuevoEst.value); nuevoEst.value=''">
          <i class="fas fa-plus"></i> Agregar
        </button>
      </div>
      <ul class="lista-estudiantes">
        <li *ngFor="let est of otrosEstudiantes">{{ est }}</li>
      </ul>
    </div>

    <div class="form-group">
      <label><i class="fas fa-university icono azul"></i> Campus</label>
      <select [(ngModel)]="campus" name="campus" (change)="cargarHorasOcupadas()">
        <option value="">Seleccione un campus</option>
        <option *ngFor="let c of campusOpciones" [value]="c">{{ c }}</option>
      </select>
    </div>

    <div class="form-group">
      <label><i class="fas fa-map-marker-alt icono rojo"></i> Sede</label>
      <input type="text" [(ngModel)]="sede" name="sede" placeholder="Sede de la reservación" (change)="cargarHorasOcupadas()">
    </div>

    <div class="form-group">
      <label><i class="fas fa-chalkboard icono beige"></i> Tipo de aula</label>
      <select [(ngModel)]="tipoAula" name="tipoAula" (change)="cargarHorasOcupadas()">
        <option value="">Seleccione tipo de aula</option>
        <option value="Salón de estudio">Salón de estudio</option>
        <option value="Laboratorio">Laboratorio</option>
        <option value="Aula para eventos">Aula para eventos</option>
        <option value="Aula normal">Aula normal</option>
      </select>
    </div>

    <div class="form-group">
      <label><i class="fas fa-door-open icono beige"></i> Número de Aula</label>
      <input type="text" [(ngModel)]="numeroaula" name="numeroaula" placeholder="Número de Aula" required (change)="cargarHorasOcupadas()">
    </div>

    <div class="form-group">
      <label><i class="fas fa-calendar-alt icono azul"></i> Fecha</label>
      <input type="date" [(ngModel)]="fecha" name="fecha" required (change)="cargarHorasOcupadas()">
    </div>

    <div class="form-group">
      <label><i class="fas fa-clock icono rojo"></i> Hora</label>
      <select [(ngModel)]="hora" name="hora">
        <option value="">Seleccione una hora</option>
        <option *ngFor="let h of horasDisponibles" [value]="h"
          [disabled]="horasOcupadas.includes(h)"
          [ngStyle]="{'color': horasOcupadas.includes(h) ? 'red' : '#000', 'text-decoration': horasOcupadas.includes(h) ? 'line-through' : 'none'}">
          {{ h }}
        </option>
      </select>
    </div>

    <div class="botones-formulario">
      <button type="button" class="btn-aceptar" (click)="aceptarReservacion()">
        <i class="fas fa-check-circle"></i> Aceptar
      </button>
    </div>
  </form>

  <!-- RESUMEN -->
  <div *ngIf="resumen" class="resumen-reservacion">
    <div class="info-resumen">
      <div class="resumen-item"><span class="resumen-label">Nombre:</span> {{ resumen.nombre }}</div>
      <div class="resumen-item"><span class="resumen-label">Cuenta:</span> {{ resumen.numeroCuenta }}</div>
      <div class="resumen-item"><span class="resumen-label">Correo:</span> {{ resumen.correo }}</div>
      <div class="resumen-item"><span class="resumen-label">Otros estudiantes:</span> {{ resumen.otrosEstudiantes.join(', ') || 'Ninguno' }}</div>
      <div class="resumen-item"><span class="resumen-label">Campus:</span> {{ resumen.campus }}</div>
      <div class="resumen-item"><span class="resumen-label">Sede:</span> {{ resumen.sede }}</div>
      <div class="resumen-item"><span class="resumen-label">Tipo de aula:</span> {{ resumen.tipoAula }}</div>
      <div class="resumen-item"><span class="resumen-label">Aula:</span> {{ resumen.numeroaula }}</div>
      <div class="resumen-item"><span class="resumen-label">Fecha:</span> {{ resumen.fecha }}</div>
      <div class="resumen-item"><span class="resumen-label">Hora:</span> {{ resumen.hora }}</div>
    </div>

    <div class="botones-resumen">
      <button class="btn-confirmar" (click)="confirmarReservacion()"><i class="fas fa-check"></i> Confirmar</button>
      <button class="btn-actualizar" (click)="actualizarReservacion()"><i class="fas fa-edit"></i> Actualizar</button>
      <button class="btn-cancelar" (click)="cancelarReservacion()"><i class="fas fa-times"></i> Cancelar</button>
    </div>

    <div *ngIf="qrDataUrl" class="qr-container">
      <h4>Código QR de tu reservación</h4>
      <img [src]="qrDataUrl" alt="Código QR">
    </div>
  </div>
</div>
